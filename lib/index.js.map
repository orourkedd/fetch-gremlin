{"version":3,"sources":["../src/index.js"],"names":["fetch","require","module","exports","failureProbability","shouldFail","Error","responseInit","status","statusText","responseBlob","Blob","response","Response","init","Promise","resolve","apply","arguments","Math","random"],"mappings":";;AAAA,IAAMA,QAAQC,QAAQ,kBAAR,CAAd;;AAEAC,OAAOC,OAAP,GAAiB,YAAmC;AAAA,MAA1BC,kBAA0B,uEAAL,GAAK;;AAClD,SAAO,YAAW;AAChB,QAAIC,WAAWD,qBAAqB,CAAhC,CAAJ,EACE,MAAM,IAAIE,KAAJ,CAAU,kCAAV,CAAN;;AAEF,QAAID,WAAWD,qBAAqB,CAAhC,CAAJ,EAAwC;AACtC,UAAMG,eAAe;AACnBC,gBAAQ,GADW;AAEnBC,oBAAY;AAFO,OAArB;AAIA,UAAMC,eAAe,IAAIC,IAAJ,EAArB;AACA,UAAMC,WAAW,IAAIC,QAAJ,CAAaH,YAAb,EAA2BI,IAA3B,CAAjB;AACA,aAAOC,QAAQC,OAAR,CAAgBJ,QAAhB,CAAP;AACD;;AAED,WAAOZ,MAAMiB,KAAN,CAAYjB,KAAZ,EAAmBkB,SAAnB,CAAP;AACD,GAfD;AAgBD,CAjBD;;AAmBA,SAASb,UAAT,CAAoBD,kBAApB,EAAwC;AACtC,SAAOA,sBAAsBe,KAAKC,MAAL,EAA7B;AACD","file":"index.js","sourcesContent":["const fetch = require('fetch-everywhere')\n\nmodule.exports = function(failureProbability = 0.2) {\n  return function() {\n    if (shouldFail(failureProbability / 2))\n      throw new Error('Unexpected Error (Fetch Gremlin)')\n\n    if (shouldFail(failureProbability / 2)) {\n      const responseInit = {\n        status: 500,\n        statusText: 'Internal Server Error (Fetch Gremlin)'\n      }\n      const responseBlob = new Blob()\n      const response = new Response(responseBlob, init)\n      return Promise.resolve(response)\n    }\n\n    return fetch.apply(fetch, arguments)\n  }\n}\n\nfunction shouldFail(failureProbability) {\n  return failureProbability >= Math.random()\n}\n"]}